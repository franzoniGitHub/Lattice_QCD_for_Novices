<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lattice QCD for Novices: Vegas Integration: VegasHarmOsc.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lattice QCD for Novices: Vegas Integration
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">VegasHarmOsc.C File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Code to path integrate a harmonic oscillator by direct integration.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;gsl/gsl_math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_monte.h&gt;</code><br />
<code>#include &lt;gsl/gsl_monte_vegas.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &quot;<a class="el" href="SETTINGS_8h_source.html">../SETTINGS.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for VegasHarmOsc.C:</div>
<div class="dyncontent">
<div class="center"><img src="VegasHarmOsc_8C__incl.png" border="0" usemap="#VegasHarmOsc_8C" alt=""/></div>
<map name="VegasHarmOsc_8C" id="VegasHarmOsc_8C">
<area shape="rect" id="node8" href="SETTINGS_8h.html" title="Header file to set the adjustable parameters of the system. " alt="" coords="733,80,845,107"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structphysical__params.html">physical_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aac6be79c75fa74b6c83eccd0cca674c2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="VegasHarmOsc_8C.html#aac6be79c75fa74b6c83eccd0cca674c2">V</a> (double x, <a class="el" href="structphysical__params.html">physical_params</a> *fp)</td></tr>
<tr class="separator:aac6be79c75fa74b6c83eccd0cca674c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3334f58920631837c4bfddd844721e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="VegasHarmOsc_8C.html#a7f3334f58920631837c4bfddd844721e">integrand</a> (double *path, size_t dim, void *params)</td></tr>
<tr class="separator:a7f3334f58920631837c4bfddd844721e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a52e309667562f6b82af8be260b9b6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="VegasHarmOsc_8C.html#a81a52e309667562f6b82af8be260b9b6">asymptotic</a> (double x, <a class="el" href="structphysical__params.html">physical_params</a> *fp)</td></tr>
<tr class="separator:a81a52e309667562f6b82af8be260b9b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Code to path integrate a harmonic oscillator by direct integration. </p>
<p>In the main function, the physical parameters are set and the loop path integration is performed using the GSL implementation of the Vega routine. The integration is repeated using different values of the start-end point x, so as to provide data to approximate the shape of the ground state function of the system. See also the GSL manual at <a href="https://www.gnu.org/software/gsl/doc/html/index.html">https://www.gnu.org/software/gsl/doc/html/index.html</a>. Follow the comments in the source code of the main function below for a more detailed description. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line"><span class="preprocessor">  #include &quot;../PARAMS.h&quot;</span> <span class="comment">//Include the parameters definition</span></div><div class="line"></div><div class="line">  <span class="keywordtype">double</span> res, err; <span class="comment">//result and error outputs</span></div><div class="line">  <span class="keywordtype">double</span> xl[<a class="code" href="SETTINGS_8h.html#a5a29df15e64ed75d6c8a5e611288760e">N_dim</a>-1]; <span class="comment">//lower bound vector</span></div><div class="line">  <span class="keywordtype">double</span> xu[<a class="code" href="SETTINGS_8h.html#a5a29df15e64ed75d6c8a5e611288760e">N_dim</a>-1]; <span class="comment">//upper bound vector</span></div><div class="line"></div><div class="line">  <span class="comment">//initialization of the bound vectors</span></div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="SETTINGS_8h.html#a5a29df15e64ed75d6c8a5e611288760e">N_dim</a>-1; i++) {</div><div class="line">  xl[i]=-<a class="code" href="SETTINGS_8h.html#a8e46cd418f096122412bce3fe201a6a1">space_bound</a>;</div><div class="line">  xu[i]=<a class="code" href="SETTINGS_8h.html#a8e46cd418f096122412bce3fe201a6a1">space_bound</a>;</div><div class="line">  }</div><div class="line">  <span class="keywordtype">size_t</span> dimension=(size_t)(N_dim-1);</div><div class="line"></div><div class="line">  <span class="comment">//Definition and initialization of GSL random generation variables</span></div><div class="line">  <span class="comment">//These are necessary for the Vegas routine, which uses Montecarlo importance sampling</span></div><div class="line">  <span class="keyword">const</span> gsl_rng_type *T;</div><div class="line">  gsl_rng *my_gsl_rng;</div><div class="line">  gsl_rng_env_setup();</div><div class="line">  T = gsl_rng_default;</div><div class="line">  my_gsl_rng = gsl_rng_alloc(T);</div><div class="line"></div><div class="line">  <span class="comment">//Prepare for the output on standard output with a header</span></div><div class="line">  std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(8) &lt;&lt; <span class="stringliteral">&quot;x\tpath integral\tsigma\texact asymptotic\n&quot;</span>;</div><div class="line"></div><div class="line">  <span class="comment">//Open an output file and print a header</span></div><div class="line">  std::ofstream out_file(<span class="stringliteral">&quot;output_file.dat&quot;</span>);</div><div class="line">  out_file &lt;&lt; std::fixed &lt;&lt; std::setprecision(8) &lt;&lt; <span class="stringliteral">&quot;x\tpath integral\tsigma\texact asymptotic\n&quot;</span>;</div><div class="line"></div><div class="line">  <span class="comment">//Evaluate the path integral for different cyclic boundary conditions contained in my_fp</span></div><div class="line">  <span class="keywordtype">double</span> total_integral = 0.0;</div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">double</span> x_now=-<a class="code" href="SETTINGS_8h.html#ad1f92e371906b2849bfc06466c3a32b9">x_loop_bound</a>; x_now&lt;=<a class="code" href="SETTINGS_8h.html#ad1f92e371906b2849bfc06466c3a32b9">x_loop_bound</a>+1.e-8; x_now+=<a class="code" href="SETTINGS_8h.html#aa27d69a0e4469dc569c73a7b53eae3f1">x_loop_step</a>)</div><div class="line">  {</div><div class="line">    <span class="keywordtype">size_t</span> calls = 500000; <span class="comment">//Number of calls of the integration routine</span></div><div class="line">    <span class="keyword">struct </span><a class="code" href="structphysical__params.html">physical_params</a> my_fp={x_now, <a class="code" href="SETTINGS_8h.html#a8f90d3b72895fb3d1092b6350ca261aa">time_bound</a>, <a class="code" href="SETTINGS_8h.html#a244bf42c46054cf1113be44d55f2156d">mass</a>}; <span class="comment">//Setting the physical parameters</span></div><div class="line"></div><div class="line">    <span class="comment">//Definition of the function with parameters for Montecarlo integration</span></div><div class="line">    gsl_monte_function my_gsl_integrand = { &amp;<a class="code" href="VegasHarmOsc_8C.html#a7f3334f58920631837c4bfddd844721e">integrand</a>, dimension,  &amp;my_fp};</div><div class="line">    </div><div class="line">    <span class="comment">//Definition and initialization of a workspace to maintain the state of integration</span></div><div class="line">    gsl_monte_vegas_state *my_gsl_state = gsl_monte_vegas_alloc(dimension);</div><div class="line">    </div><div class="line">    <span class="comment">//Vegas routine to integrate over the hypercubic region whose lower and upper limits are defined by xl and xup, respectively</span></div><div class="line">    <span class="comment">//Do 10000 iterations and store result and error in res and error</span></div><div class="line">    gsl_monte_vegas_integrate(&amp;my_gsl_integrand, xl, xu, dimension, 10000, my_gsl_rng, my_gsl_state, &amp;res, &amp;err);</div><div class="line">    <span class="keywordflow">do</span> <span class="comment">//Iterate the integration until the required accuracy target is met, namely, when Chisquare/#dofs is sufficiently close to 1</span></div><div class="line">      {</div><div class="line">        gsl_monte_vegas_integrate(&amp;my_gsl_integrand, xl, xu, dimension, calls/5, my_gsl_rng, my_gsl_state, &amp;res, &amp;err);</div><div class="line">      }</div><div class="line">    <span class="keywordflow">while</span> (fabs(gsl_monte_vegas_chisq(my_gsl_state) - 1.0) &gt; 0.5);</div><div class="line">    </div><div class="line">    <span class="comment">//Print all the results for x=x_now</span></div><div class="line">    std::cout &lt;&lt; x_now &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; res &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; err &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="VegasHarmOsc_8C.html#a81a52e309667562f6b82af8be260b9b6">asymptotic</a>(x_now, &amp;my_fp) &lt;&lt; std::endl;</div><div class="line">    out_file &lt;&lt; x_now &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; res &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; err &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; <a class="code" href="VegasHarmOsc_8C.html#a81a52e309667562f6b82af8be260b9b6">asymptotic</a>(x_now, &amp;my_fp) &lt;&lt; std::endl;</div><div class="line">    </div><div class="line">    <span class="comment">//Update a rough estimate of the integral of the path integral over the start-end points x</span></div><div class="line">    total_integral += <a class="code" href="SETTINGS_8h.html#aa27d69a0e4469dc569c73a7b53eae3f1">x_loop_step</a>*res;</div><div class="line">    </div><div class="line">    <span class="comment">//Free the memory allocated</span></div><div class="line">    gsl_monte_vegas_free(my_gsl_state);</div><div class="line">  }</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Estimate of the zero energy level E_0=&quot;</span> &lt;&lt; -(log(total_integral))/<a class="code" href="SETTINGS_8h.html#a8f90d3b72895fb3d1092b6350ca261aa">time_bound</a> &lt;&lt; std::endl;</div><div class="line">  </div><div class="line">  <span class="comment">//Free the memory allocated and close the output file</span></div><div class="line">  gsl_rng_free(my_gsl_rng);</div><div class="line">  out_file.close();</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a81a52e309667562f6b82af8be260b9b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81a52e309667562f6b82af8be260b9b6">&#9670;&nbsp;</a></span>asymptotic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double asymptotic </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysical__params.html">physical_params</a> *&#160;</td>
          <td class="paramname"><em>fp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Asymptotic exact function</p>
<p>Asymptotic exact function in the large time limit computed from standard quantum mechanics </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>position </td></tr>
    <tr><td class="paramname">fp</td><td>pointer to the set of parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><p class="formulaDsp">
<img class="formulaDsp" alt="\[\left|\left\langle \psi | E_{0}\right\rangle\right|^{2}e^{-E_{0}T}=\frac{1}{\sqrt{\pi}}e^{-x^{2}-E_{0}T}\]" src="form_6.png"/>
</p>
 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structphysical__params.html">physical_params</a> </dd></dl>

</div>
</div>
<a id="a7f3334f58920631837c4bfddd844721e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f3334f58920631837c4bfddd844721e">&#9670;&nbsp;</a></span>integrand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double integrand </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Integrand of the path integral</p>
<p>Function to compute the integrand in the path integral. When evaluating the action, periodic boundary conditions are implemented. The signature of this function is dictated by its use within the GSL library. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>array containing the discretized 1D path </td></tr>
    <tr><td class="paramname">dim</td><td>{size of the path array (due to periodic boundary conditions, it corresponds to N-1, where N is the lattice size)} </td></tr>
    <tr><td class="paramname">params</td><td>pointer to the set of physical parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><img class="formulaInl" alt="$Ae^{-S}$" src="form_0.png"/>, where <img class="formulaInl" alt="$S$" src="form_1.png"/> is the action evaluated on the path and <img class="formulaInl" alt="$A=(\frac{m}{2\pi a})^{N/2}$" src="form_2.png"/>, <img class="formulaInl" alt="$m$" src="form_3.png"/> being the mass and <img class="formulaInl" alt="$a=\frac{T}{N}$" src="form_4.png"/>. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structphysical__params.html">physical_params</a> </dd></dl>

</div>
</div>
<a id="aac6be79c75fa74b6c83eccd0cca674c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac6be79c75fa74b6c83eccd0cca674c2">&#9670;&nbsp;</a></span>V()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double V </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysical__params.html">physical_params</a> *&#160;</td>
          <td class="paramname"><em>fp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Potential</p>
<p>Function defining the shape of the potential felt by the particle: modify this to change the interaction. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>position </td></tr>
    <tr><td class="paramname">fp</td><td>pointer to the set of parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of the potential computed in <em>x</em> </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structphysical__params.html">physical_params</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
